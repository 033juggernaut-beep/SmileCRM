# –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **Telegram Bot (aiogram)**  
   - –ö–æ–º–∞–Ω–¥–∞ `/start`  
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Ä–∞—á–∞ (–∏–º—è, —Ñ–∞–º–∏–ª–∏—è, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Ç–µ–ª–µ—Ñ–æ–Ω, –∫–ª–∏–Ω–∏–∫–∞)  
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ / —Ç—Ä–∏–∞–ª–∞  
   - –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App  
   - –ú–µ–Ω—é:
     - ‚ûï ‘±’æ’•’¨’°÷Å’∂’•’¨ ’∂’∏÷Ä ’∫’°÷Å’´’•’∂’ø
     - üìã ‘ª’¥ ’∫’°÷Å’´’•’∂’ø’∂’•÷Ä’®
     - üí≥ ‘≤’°’™’°’∂’∏÷Ä’§’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂
     - ‚ÑπÔ∏è ’ï’£’∂’∏÷Ç’©’µ’∏÷Ç’∂
     - üîí ‘≥’°’≤’ø’∂’´’∏÷Ç’©’µ’°’∂ ÷Ñ’°’≤’°÷Ñ’°’Ø’°’∂’∏÷Ç’©’µ’∏÷Ç’∂

2. **Mini App (React + Vite)**  
   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp initData
   - –í—ã–∑–æ–≤ API –±—ç–∫–µ–Ω–¥–∞ —Å –ø–æ–¥–ø–∏—Å—å—é (validate initData)
   - –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –≤—Ä–∞—á –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)
   - –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω:
     - –ú–æ–∏ –ø–∞—Ü–∏–µ–Ω—Ç—ã (—Å–ø–∏—Å–æ–∫)
     - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞
     - –ü–æ–¥–ø–∏—Å–∫–∞ (—Å—Ç–∞—Ç—É—Å, –æ–ø–ª–∞—Ç–∞)
     - –ü–æ–º–æ—â—å
     - –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
   - –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞:
     - –ò–º—è, —Ñ–∞–º–∏–ª–∏—è
     - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∏–∑–∏—Ç–∞
     - –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–∑–∏—Ç–∞
     - –î–∏–∞–≥–Ω–æ–∑
     - –°—Ç–∞—Ç—É—Å (–∑–∞–≤–µ—Ä—à–µ–Ω / –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
     - –ó–∞–º–µ—Ç–∫–∏
     - –ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã (—Ä–µ–Ω—Ç–≥–µ–Ω, —Ñ–æ—Ç–æ)

3. **Backend API (FastAPI)**  
   - Auth:
     - –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData
     - –ü—Ä–∏–≤—è–∑–∫–∞ telegram_user_id –∫ doctor
   - Endpoints –¥–ª—è Mini App:
     - `/me` ‚Äì –¥–∞–Ω–Ω—ã–µ –≤—Ä–∞—á–∞
     - `/patients` ‚Äì CRUD
     - `/visits` ‚Äì CRUD
     - `/media` ‚Äì –∑–∞–≥—Ä—É–∑–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫
     - `/subscription` ‚Äì —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
   - Webhooks:
     - `/webhook/payments/idram`
     - `/webhook/payments/idbank`

4. **Supabase (DB + Storage)**  
   - Postgres-—Å—Ö–µ–º–∞ –¥–ª—è –≤—Ä–∞—á–µ–π, –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, –≤–∏–∑–∏—Ç–æ–≤, –ø–æ–¥–ø–∏—Å–∫–∏
   - Storage –¥–ª—è –º–µ–¥–∏–∞-—Ñ–∞–π–ª–æ–≤
   - –í–æ–∑–º–æ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Row Level Security (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –°–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

- Telegram Bot:
  - –ü—Ä–∏ `/start` —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç / –Ω–∞—Ö–æ–¥–∏—Ç –≤—Ä–∞—á–∞ –≤ Supabase —á–µ—Ä–µ–∑ Backend API
  - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç WebApp —Å —Ç–µ–º –∂–µ Telegram user_id
- Mini App:
  - –ü–æ–ª—É—á–∞–µ—Ç initData –æ—Ç Telegram
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Backend `/auth/telegram` ‚Üí –ø–æ–ª—É—á–∞–µ—Ç JWT (–∏–ª–∏ session token)
  - –í—Å–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω
- Backend:
  - –†–∞–±–æ—Ç–∞–µ—Ç —Å Supabase (—á–µ—Ä–µ–∑ PostgREST, Supabase SDK –∏–ª–∏ –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
  - –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–ª–∞—Ç–µ–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç `subscriptions` –∏ —Å—Ç–∞—Ç—É—Å –≤—Ä–∞—á–∞
